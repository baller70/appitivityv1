(()=>{var e={};e.id=3549,e.ids=[3549],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27910:e=>{"use strict";e.exports=require("stream")},28270:(e,t,r)=>{"use strict";r.d(t,{s2:()=>c});var s=r(55511);let a=function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),(0,s.createHash)("sha1").update(e).digest()},o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i,i=function(e){let t;if(!("string"==typeof e&&o.test(e)))throw TypeError("Invalid UUID");return Uint8Array.of((t=parseInt(e.slice(0,8),16))>>>24,t>>>16&255,t>>>8&255,255&t,(t=parseInt(e.slice(9,13),16))>>>8,255&t,(t=parseInt(e.slice(14,18),16))>>>8,255&t,(t=parseInt(e.slice(19,23),16))>>>8,255&t,(t=parseInt(e.slice(24,36),16))/0x10000000000&255,t/0x100000000&255,t>>>24&255,t>>>16&255,t>>>8&255,255&t)},n=[];for(let e=0;e<256;++e)n.push((e+256).toString(16).slice(1));function u(e,t,r,s){var o=t,u=s;let c="string"==typeof e?function(e){let t=new Uint8Array((e=unescape(encodeURIComponent(e))).length);for(let r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return t}(e):e,f="string"==typeof o?i(o):o;if("string"==typeof o&&(o=i(o)),o?.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let l=new Uint8Array(16+c.length);if(l.set(f),l.set(c,f.length),(l=a(l))[6]=15&l[6]|80,l[8]=63&l[8]|128,r){u=u||0;for(let e=0;e<16;++e)r[u+e]=l[e];return r}return function(e,t=0){return(n[e[t+0]]+n[e[t+1]]+n[e[t+2]]+n[e[t+3]]+"-"+n[e[t+4]]+n[e[t+5]]+"-"+n[e[t+6]]+n[e[t+7]]+"-"+n[e[t+8]]+n[e[t+9]]+"-"+n[e[t+10]]+n[e[t+11]]+n[e[t+12]]+n[e[t+13]]+n[e[t+14]]+n[e[t+15]]).toLowerCase()}(l)}function c(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)?e:u(e,"6ba7b810-9dad-11d1-80b4-00c04fd430c8")}u.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",u.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8"},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:e=>{"use strict";e.exports=require("tls")},39727:()=>{},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},47990:()=>{},53817:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>w,routeModule:()=>p,serverHooks:()=>b,workAsyncStorage:()=>h,workUnitAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{GET:()=>d,POST:()=>g});var a=r(96559),o=r(48088),i=r(37719),n=r(32190),u=r(60166),c=r(56621),f=r(28270);class l{constructor(e){this.userId=(0,f.s2)(e),this.supabase=(0,c.Sw)(this.userId)}async getTags(){let{data:e,error:t}=await this.supabase.from("tags").select("*").eq("user_id",this.userId).order("name");if(t)throw Error(`Failed to fetch tags: ${t.message}`);return e||[]}async getTagsWithCounts(){let{data:e,error:t}=await this.supabase.from("tags").select(`
        *,
        bookmark_tags(count)
      `).eq("user_id",this.userId).order("name");if(t)throw Error(`Failed to fetch tags with counts: ${t.message}`);return e?.map(e=>({...e,bookmarkCount:e.bookmark_tags?.[0]?.count||0}))||[]}async getTag(e){let{data:t,error:r}=await this.supabase.from("tags").select("*").eq("id",e).eq("user_id",this.userId).single();if(r){if("PGRST116"===r.code)return null;throw Error(`Failed to fetch tag: ${r.message}`)}return t}async getTagByName(e){let{data:t,error:r}=await this.supabase.from("tags").select("*").eq("user_id",this.userId).ilike("name",e).single();if(r){if("PGRST116"===r.code)return null;throw Error(`Failed to fetch tag by name: ${r.message}`)}return t}async createTag(e){if(await this.getTagByName(e.name))throw Error(`Tag with name "${e.name}" already exists`);let{data:t,error:r}=await this.supabase.from("tags").insert({...e,user_id:this.userId}).select().single();if(r)throw Error(`Failed to create tag: ${r.message}`);return t}async updateTag(e,t){if(t.name){let r=await this.getTagByName(t.name);if(r&&r.id!==e)throw Error(`Tag with name "${t.name}" already exists`)}let{data:r,error:s}=await this.supabase.from("tags").update(t).eq("id",e).eq("user_id",this.userId).select().single();if(s)throw Error(`Failed to update tag: ${s.message}`);return r}async deleteTag(e){await this.supabase.from("bookmark_tags").delete().eq("tag_id",e);let{error:t}=await this.supabase.from("tags").delete().eq("id",e).eq("user_id",this.userId);if(t)throw Error(`Failed to delete tag: ${t.message}`)}async searchTags(e){let{data:t,error:r}=await this.supabase.from("tags").select("*").eq("user_id",this.userId).ilike("name",`%${e}%`).order("name");if(r)throw Error(`Failed to search tags: ${r.message}`);return t||[]}async getPopularTags(e=10){let{data:t,error:r}=await this.supabase.from("tags").select(`
        *,
        bookmark_tags(count)
      `).eq("user_id",this.userId).order("bookmark_tags.count",{ascending:!1}).limit(e);if(r)throw Error(`Failed to fetch popular tags: ${r.message}`);return t?.map(e=>({...e,bookmarkCount:e.bookmark_tags?.[0]?.count||0}))||[]}async getUnusedTags(){let{data:e,error:t}=await this.supabase.from("tags").select(`
        *,
        bookmark_tags(count)
      `).eq("user_id",this.userId).or("bookmark_tags.count.eq.0,bookmark_tags.count.is.null").order("name");if(t)throw Error(`Failed to fetch unused tags: ${t.message}`);return e||[]}async getBookmarkTags(e){let{data:t,error:r}=await this.supabase.from("bookmark_tags").select("tag:tags(*)").eq("bookmark_id",e);if(r)throw Error(`Failed to fetch bookmark tags: ${r.message}`);return t?.map(e=>e.tag).filter(Boolean)||[]}async createOrGetTag(e,t){let r=await this.getTagByName(e);return r||this.createTag({name:e.trim(),color:t||this.generateRandomColor()})}async bulkCreateTags(e){let t=[...new Set(e.map(e=>e.trim()))],r=[];for(let e of t)if(e)try{let t=await this.createOrGetTag(e);r.push(t)}catch(t){console.warn(`Failed to create tag "${e}":`,t)}return r}async mergeTags(e,t){let{data:r,error:s}=await this.supabase.from("bookmark_tags").select("bookmark_id").eq("tag_id",e);if(s)throw Error(`Failed to fetch bookmark tags: ${s.message}`);if(r&&r.length>0)for(let s of(await this.supabase.from("bookmark_tags").delete().eq("tag_id",e),r))try{await this.supabase.from("bookmark_tags").insert({bookmark_id:s.bookmark_id,tag_id:t})}catch(e){}await this.deleteTag(e)}generateRandomColor(){let e=["#ef4444","#f97316","#f59e0b","#eab308","#84cc16","#22c55e","#10b981","#14b8a6","#06b6d4","#0ea5e9","#3b82f6","#6366f1","#8b5cf6","#a855f7","#d946ef","#ec4899","#f43f5e"];return e[Math.floor(Math.random()*e.length)]}async cleanupUnusedTags(){let e=await this.getUnusedTags();for(let t of e)await this.deleteTag(t.id);return e.length}}async function d(){try{let{userId:e}=await (0,u.j)(),t=e||"demo-user";if(!t)return n.NextResponse.json({error:"No user session"},{status:401});let r=new l(t),s=await r.getTags();return n.NextResponse.json(s)}catch(e){return console.error("Error fetching tags:",e),n.NextResponse.json({error:"Failed to fetch tags"},{status:500})}}async function g(e){try{let{userId:t}=await (0,u.j)(),r=t||"demo-user";if(!r)return n.NextResponse.json({error:"No user session"},{status:401});let s=await e.json(),a=new l(r),o=await a.createTag(s);return n.NextResponse.json(o)}catch(e){return console.error("Error creating tag:",e),n.NextResponse.json({error:"Failed to create tag"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/tags/route",pathname:"/api/tags",filename:"route",bundlePath:"app/api/tags/route"},resolvedPagePath:"/Volumes/Softwaare Program/apptivity final v1/src/app/api/tags/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:h,workUnitAsyncStorage:m,serverHooks:b}=p;function w(){return(0,i.patchFetch)({workAsyncStorage:h,workUnitAsyncStorage:m})}},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},56621:(e,t,r)=>{"use strict";let s;r.d(t,{E2:()=>u,ND:()=>n,Sw:()=>c});var a=r(78521);let o="https://bpmixidxyljfvenukcun.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJwbWl4aWR4eWxqZnZlbnVrY3VuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg4ODAwMjIsImV4cCI6MjA2NDQ1NjAyMn0.JmyZhvuPfJlzQ9PPEclEc7mKBd55zCEM61nci7fjazc",n=(0,a.UU)(o,i,{auth:{persistSession:!1,autoRefreshToken:!1,detectSessionInUrl:!1}});(s=process.env.SUPABASE_SERVICE_ROLE_KEY)||console.warn("WARNING: SUPABASE_SERVICE_ROLE_KEY not found on server. Some operations may fail.");let u=s?(0,a.UU)(o,s,{auth:{persistSession:!1,autoRefreshToken:!1,detectSessionInUrl:!1}}):null;function c(e){return(0,a.UU)(o,i,{auth:{persistSession:!1,autoRefreshToken:!1,detectSessionInUrl:!1},global:{headers:{"x-user-id":e}}})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73024:e=>{"use strict";e.exports=require("node:fs")},74075:e=>{"use strict";e.exports=require("zlib")},76760:e=>{"use strict";e.exports=require("node:path")},77598:e=>{"use strict";e.exports=require("node:crypto")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[80,166,5575],()=>r(53817));module.exports=s})();